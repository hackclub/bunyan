var socket
function connectSocket() {
  socket = new WebSocket(`ws://${window.location.host}`)
  socket.onopen = event => {
    console.log({event})
  }
  socket.onclose = event => {
    console.log("Socket closed. Attempting reconnect in 1 second.", event.reason)
  }

  socket.onmessage = event => {
    const { emoji, url } = JSON.parse(event.data)
    triggerEmoji(emoji)
  }

  return socket
}

connectSocket()
// setInterval(() => {
//   if (!socket || socket.readyState !== socket.OPEN) {
//     connectSocket()
//   }
// }, 5000)

// mock emoji triggering for the time being:
function mockEmojiTrigger() {
  let emojis = [
    'ðŸ˜„','ðŸ˜ƒ','ðŸ˜€','ðŸ˜Š','â˜º','ðŸ˜‰','ðŸ˜','ðŸ˜˜','ðŸ˜š','ðŸ˜—','ðŸ˜™','ðŸ˜œ','ðŸ˜','ðŸ˜›','ðŸ˜³','ðŸ˜','ðŸ˜”','ðŸ˜Œ','ðŸ˜’','ðŸ˜ž','ðŸ˜£','ðŸ˜¢','ðŸ˜‚','ðŸ˜­','ðŸ˜ª','ðŸ˜¥','ðŸ˜°','ðŸ˜…','ðŸ˜“','ðŸ˜©','ðŸ˜«','ðŸ˜¨','ðŸ˜±','ðŸ˜ ','ðŸ˜¡','ðŸ˜¤','ðŸ˜–','ðŸ˜†','ðŸ˜‹','ðŸ˜·','ðŸ˜Ž','ðŸ˜´','ðŸ˜µ','ðŸ˜²','ðŸ˜Ÿ','ðŸ˜¦','ðŸ˜§','ðŸ˜ˆ','ðŸ‘¿','ðŸ˜®','ðŸ˜¬','ðŸ˜','ðŸ˜•','ðŸ˜¯','ðŸ˜¶','ðŸ˜‡','ðŸ˜','ðŸ˜‘','ðŸ‘²','ðŸ‘³','ðŸ‘®','ðŸ‘·','ðŸ’‚','ðŸ‘¶','ðŸ‘¦','ðŸ‘§','ðŸ‘¨','ðŸ‘©','ðŸ‘´','ðŸ‘µ','ðŸ‘±','ðŸ‘¼','ðŸ‘¸','ðŸ˜º','ðŸ˜¸','ðŸ˜»','ðŸ˜½','ðŸ˜¼','ðŸ™€','ðŸ˜¿','ðŸ˜¹','ðŸ˜¾','ðŸ‘¹','ðŸ‘º','ðŸ™ˆ','ðŸ™‰','ðŸ™Š','ðŸ’€','ðŸ‘½','ðŸ’©','ðŸ”¥','âœ¨','ðŸŒŸ','ðŸ’«','ðŸ’¥','ðŸ’¢','ðŸ’¦','ðŸ’§','ðŸ’¤','ðŸ’¨','ðŸ‘‚','ðŸ‘€','ðŸ‘ƒ','ðŸ‘…','ðŸ‘„','ðŸ‘','ðŸ‘Ž','ðŸ‘Œ','ðŸ‘Š','âœŠ','âœŒ','ðŸ‘‹','âœ‹','ðŸ‘','ðŸ‘†','ðŸ‘‡','ðŸ‘‰','ðŸ‘ˆ','ðŸ™Œ','ðŸ™','â˜','ðŸ‘','ðŸ’ª','ðŸš¶','ðŸƒ','ðŸ’ƒ','ðŸ‘«','ðŸ‘ª','ðŸ‘¬','ðŸ‘­','ðŸ’','ðŸ’‘','ðŸ‘¯','ðŸ™†','ðŸ™…','ðŸ’','ðŸ™‹','ðŸ’†','ðŸ’‡','ðŸ’…','ðŸ‘°','ðŸ™Ž','ðŸ™','ðŸ™‡','ðŸŽ©','ðŸ‘‘','ðŸ‘’','ðŸ‘Ÿ','ðŸ‘ž','ðŸ‘¡','ðŸ‘ ','ðŸ‘¢','ðŸ‘•','ðŸ‘”','ðŸ‘š','ðŸ‘—','ðŸŽ½','ðŸ‘–','ðŸ‘˜','ðŸ‘™','ðŸ’¼','ðŸ‘œ','ðŸ‘','ðŸ‘›','ðŸ‘“','ðŸŽ€','ðŸŒ‚','ðŸ’„','ðŸ’›','ðŸ’™','ðŸ’œ','ðŸ’š','â¤','ðŸ’”','ðŸ’—','ðŸ’“','ðŸ’•','ðŸ’–','ðŸ’ž','ðŸ’˜','ðŸ’Œ','ðŸ’‹','ðŸ’','ðŸ’Ž','ðŸ‘¤','ðŸ‘¥','ðŸ’¬','ðŸ‘£','ðŸ’­','ðŸ¶','ðŸº','ðŸ±','ðŸ­','ðŸ¹','ðŸ°','ðŸ¸','ðŸ¯','ðŸ¨','ðŸ»','ðŸ·','ðŸ½','ðŸ®','ðŸ—','ðŸµ','ðŸ’','ðŸ´','ðŸ‘','ðŸ˜','ðŸ¼','ðŸ§','ðŸ¦','ðŸ¤','ðŸ¥','ðŸ£','ðŸ”','ðŸ','ðŸ¢','ðŸ›','ðŸ','ðŸœ','ðŸž','ðŸŒ','ðŸ™','ðŸš','ðŸ ','ðŸŸ','ðŸ¬','ðŸ³','ðŸ‹','ðŸ„','ðŸ','ðŸ€','ðŸƒ','ðŸ…','ðŸ‡','ðŸ‰','ðŸŽ','ðŸ','ðŸ“','ðŸ•','ðŸ–','ðŸ','ðŸ‚','ðŸ²','ðŸ¡','ðŸŠ','ðŸ«','ðŸª','ðŸ†','ðŸˆ','ðŸ©','ðŸ¾','ðŸ’','ðŸŒ¸','ðŸŒ·','ðŸ€','ðŸŒ¹','ðŸŒ»','ðŸŒº','ðŸ','ðŸƒ','ðŸ‚','ðŸŒ¿','ðŸŒ¾','ðŸ„','ðŸŒµ','ðŸŒ´','ðŸŒ²','ðŸŒ³','ðŸŒ°','ðŸŒ±','ðŸŒ¼','ðŸŒ','ðŸŒž','ðŸŒ','ðŸŒš','ðŸŒ‘','ðŸŒ’','ðŸŒ“','ðŸŒ”','ðŸŒ•','ðŸŒ–','ðŸŒ—','ðŸŒ˜','ðŸŒœ','ðŸŒ›','ðŸŒ™','ðŸŒ','ðŸŒŽ','ðŸŒ','ðŸŒ‹','ðŸŒŒ','ðŸŒ ','â­','â˜€','â›…','â˜','âš¡','â˜”','â„','â›„','ðŸŒ€','ðŸŒ','ðŸŒˆ','ðŸŒŠ','ðŸŽ','ðŸ’','ðŸŽŽ','ðŸŽ’','ðŸŽ“','ðŸŽ','ðŸŽ†','ðŸŽ‡','ðŸŽ','ðŸŽ‘','ðŸŽƒ','ðŸ‘»','ðŸŽ…','ðŸŽ„','ðŸŽ','ðŸŽ‹','ðŸŽ‰','ðŸŽŠ','ðŸŽˆ','ðŸŽŒ','ðŸ”®','ðŸŽ¥','ðŸ“·','ðŸ“¹','ðŸ“¼','ðŸ’¿','ðŸ“€','ðŸ’½','ðŸ’¾','ðŸ’»','ðŸ“±','â˜Ž','ðŸ“ž','ðŸ“Ÿ','ðŸ“ ','ðŸ“¡','ðŸ“º','ðŸ“»','ðŸ”Š','ðŸ”‰','ðŸ”ˆ','ðŸ”‡','ðŸ””','ðŸ”•','ðŸ“¢','ðŸ“£','â³','âŒ›','â°','âŒš','ðŸ”“','ðŸ”’','ðŸ”','ðŸ”','ðŸ”‘','ðŸ”Ž','ðŸ’¡','ðŸ”¦','ðŸ”†','ðŸ”…','ðŸ”Œ','ðŸ”‹','ðŸ”','ðŸ›','ðŸ›€','ðŸš¿','ðŸš½','ðŸ”§','ðŸ”©','ðŸ”¨','ðŸšª','ðŸš¬','ðŸ’£','ðŸ”«','ðŸ”ª','ðŸ’Š','ðŸ’‰','ðŸ’°','ðŸ’´','ðŸ’µ','ðŸ’·','ðŸ’¶','ðŸ’³','ðŸ’¸','ðŸ“²','ðŸ“§','ðŸ“¥','ðŸ“¤','âœ‰','ðŸ“©','ðŸ“¨','ðŸ“¯','ðŸ“«','ðŸ“ª','ðŸ“¬','ðŸ“­','ðŸ“®','ðŸ“¦','ðŸ“','ðŸ“„','ðŸ“ƒ','ðŸ“‘','ðŸ“Š','ðŸ“ˆ','ðŸ“‰','ðŸ“œ','ðŸ“‹','ðŸ“…','ðŸ“†','ðŸ“‡','ðŸ“','ðŸ“‚','âœ‚','ðŸ“Œ','ðŸ“Ž','âœ’','âœ','ðŸ“','ðŸ“','ðŸ“•','ðŸ“—','ðŸ“˜','ðŸ“™','ðŸ““','ðŸ“”','ðŸ“’','ðŸ“š','ðŸ“–','ðŸ”–','ðŸ“›','ðŸ”¬','ðŸ”­','ðŸ“°','ðŸŽ¨','ðŸŽ¬','ðŸŽ¤','ðŸŽ§','ðŸŽ¼','ðŸŽµ','ðŸŽ¶','ðŸŽ¹','ðŸŽ»','ðŸŽº','ðŸŽ·','ðŸŽ¸','ðŸ‘¾','ðŸŽ®','ðŸƒ','ðŸŽ´','ðŸ€„','ðŸŽ²','ðŸŽ¯','ðŸˆ','ðŸ€','âš½','âš¾','ðŸŽ¾','ðŸŽ±','ðŸ‰','ðŸŽ³','â›³','ðŸšµ','ðŸš´','ðŸ','ðŸ‡','ðŸ†','ðŸŽ¿','ðŸ‚','ðŸŠ','ðŸ„','ðŸŽ£','â˜•','ðŸµ','ðŸ¶','ðŸ¼','ðŸº','ðŸ»','ðŸ¸','ðŸ¹','ðŸ·','ðŸ´','ðŸ•','ðŸ”','ðŸŸ','ðŸ—','ðŸ–','ðŸ','ðŸ›','ðŸ¤','ðŸ±','ðŸ£','ðŸ¥','ðŸ™','ðŸ˜','ðŸš','ðŸœ','ðŸ²','ðŸ¢','ðŸ¡','ðŸ³','ðŸž','ðŸ©','ðŸ®','ðŸ¦','ðŸ¨','ðŸ§','ðŸŽ‚','ðŸ°','ðŸª','ðŸ«','ðŸ¬','ðŸ­','ðŸ¯','ðŸŽ','ðŸ','ðŸŠ','ðŸ‹','ðŸ’','ðŸ‡','ðŸ‰','ðŸ“','ðŸ‘','ðŸˆ','ðŸŒ','ðŸ','ðŸ','ðŸ ','ðŸ†','ðŸ…','ðŸŒ½','ðŸ ','ðŸ¡','ðŸ«','ðŸ¢','ðŸ£','ðŸ¥','ðŸ¦','ðŸª','ðŸ©','ðŸ¨','ðŸ’’','â›ª','ðŸ¬','ðŸ¤','ðŸŒ‡','ðŸŒ†','ðŸ¯','ðŸ°','â›º','ðŸ­','ðŸ—¼','ðŸ—¾','ðŸ—»','ðŸŒ„','ðŸŒ…','ðŸŒƒ','ðŸ—½','ðŸŒ‰','ðŸŽ ','ðŸŽ¡','â›²','ðŸŽ¢','ðŸš¢','â›µ','ðŸš¤','ðŸš£','âš“','ðŸš€','âœˆ','ðŸ’º','ðŸš','ðŸš‚','ðŸšŠ','ðŸš‰','ðŸšž','ðŸš†','ðŸš„','ðŸš…','ðŸšˆ','ðŸš‡','ðŸš','ðŸš‹','ðŸšƒ','ðŸšŽ','ðŸšŒ','ðŸš','ðŸš™','ðŸš˜','ðŸš—','ðŸš•','ðŸš–','ðŸš›','ðŸšš','ðŸš¨','ðŸš“','ðŸš”','ðŸš’','ðŸš‘','ðŸš','ðŸš²','ðŸš¡','ðŸšŸ','ðŸš ','ðŸšœ','ðŸ’ˆ','ðŸš','ðŸŽ«','ðŸš¦','ðŸš¥','âš ','ðŸš§','ðŸ”°','â›½','ðŸ®','ðŸŽ°','â™¨','ðŸ—¿','ðŸŽª','ðŸŽ­','ðŸ“','ðŸš©','â¬†','â¬‡','â¬…','âž¡','ðŸ” ','ðŸ”¡','ðŸ”¤','â†—','â†–','â†˜','â†™','â†”','â†•','ðŸ”„','â—€','â–¶','ðŸ”¼','ðŸ”½','â†©','â†ª','â„¹','âª','â©','â«','â¬','â¤µ','â¤´','ðŸ†—','ðŸ”€','ðŸ”','ðŸ”‚','ðŸ†•','ðŸ†™','ðŸ†’','ðŸ†“','ðŸ†–','ðŸ“¶','ðŸŽ¦','ðŸˆ','ðŸˆ¯','ðŸˆ³','ðŸˆµ','ðŸˆ´','ðŸˆ²','ðŸ‰','ðŸˆ¹','ðŸˆº','ðŸˆ¶','ðŸˆš','ðŸš»','ðŸš¹','ðŸšº','ðŸš¼','ðŸš¾','ðŸš°','ðŸš®','ðŸ…¿','â™¿','ðŸš­','ðŸˆ·','ðŸˆ¸','ðŸˆ‚','â“‚','ðŸ›‚','ðŸ›„','ðŸ›…','ðŸ›ƒ','ðŸ‰‘','ãŠ™','ãŠ—','ðŸ†‘','ðŸ†˜','ðŸ†”','ðŸš«','ðŸ”ž','ðŸ“µ','ðŸš¯','ðŸš±','ðŸš³','ðŸš·','ðŸš¸','â›”','âœ³','â‡','âŽ','âœ…','âœ´','ðŸ’Ÿ','ðŸ†š','ðŸ“³','ðŸ“´','ðŸ…°','ðŸ…±','ðŸ†Ž','ðŸ…¾','ðŸ’ ','âž¿','â™»','â™ˆ','â™‰','â™Š','â™‹','â™Œ','â™','â™Ž','â™','â™','â™‘','â™’','â™“','â›Ž','ðŸ”¯','ðŸ§','ðŸ’¹','ðŸ’²','ðŸ’±','Â©','Â®','â„¢','ã€½','ã€°','ðŸ”','ðŸ”š','ðŸ”™','ðŸ”›','ðŸ”œ','âŒ','â­•','â—','â“','â•','â”','ðŸ”ƒ','ðŸ•›','ðŸ•§','ðŸ•','ðŸ•œ','ðŸ•‘','ðŸ•','ðŸ•’','ðŸ•ž','ðŸ•“','ðŸ•Ÿ','ðŸ•”','ðŸ• ','ðŸ••','ðŸ•–','ðŸ•—','ðŸ•˜','ðŸ•™','ðŸ•š','ðŸ•¡','ðŸ•¢','ðŸ•£','ðŸ•¤','ðŸ•¥','ðŸ•¦','âœ–','âž•','âž–','âž—','â™ ','â™¥','â™£','â™¦','ðŸ’®','ðŸ’¯','âœ”','â˜‘','ðŸ”˜','ðŸ”—','âž°','ðŸ”±','ðŸ”²','ðŸ”³','â—¼','â—»','â—¾','â—½','â–ª','â–«','ðŸ”º','â¬œ','â¬›','âš«','âšª','ðŸ”´','ðŸ”µ','ðŸ”»','ðŸ”¶','ðŸ”·','ðŸ”¸','ðŸ”¹'
  ]
  triggerEmoji(emojis[Math.floor(Math.random() * emojis.length)])
  setTimeout(mockEmojiTrigger, Math.random() * 5 * 1000)
}
mockEmojiTrigger()

function triggerEmoji(emoji) {
  const container = document.querySelector('.emoji-container')
  // make explosion for the emoji to erupt from
  let explosion = document.createElement('div')
  explosion.classList.add('explosion') // duh
  explosion.innerText = 'ðŸ’¥'
  container.appendChild(explosion)
  anime({
    targets: explosion,
    duration: 500,
    scale: 10,
    rotate: anime.random(-30, 30),
    opacity: 0
  })
  setTimeout(() => {
    explosion.remove()
  }, 500)


  // then make an emoji
  console.log('triggering', emoji)
  let el = document.createElement('div')
  el.classList.add('emoji')
  el.dataset.emoji = emoji
  el.classList.add(emoji)
  container.appendChild(el)
  let duration = anime.random(2500, 5000)
  anime({
    targets: el,
    easing: 'easeOutQuad',
    translateX: anime.random(-150, 150),
    translateY: anime.random(150, 500),
    rotate: anime.random(360 * 2, 360 * 5),
    scale: anime.random(0.5, 2),
    opacity: 0,
    duration: duration,
  })
  setTimeout(() => {
    el.remove()
  }, duration)
}